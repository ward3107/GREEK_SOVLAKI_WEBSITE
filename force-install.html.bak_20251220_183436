<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Force PWA Install</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e3a8a">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; text-align: center; direction: rtl; }
        .install-card {
            background: white;
            border: 3px solid #1e3a8a;
            border-radius: 16px;
            padding: 30px;
            margin: 20px auto;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        .install-btn {
            background: #1e3a8a;
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 15px;
        }
        .install-btn:hover { background: #2563eb; }
        .manual-instructions {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="install-card">
        <h2>ğŸ“± ×”×ª×§×Ÿ ××¤×œ×™×§×¦×™×™×ª ×¡×•×‘×œ××§×™</h2>
        <p>×”×ª×§×Ÿ ××ª ×”××ª×¨ ×›××¤×œ×™×§×¦×™×” ×¢×œ ×”××›×©×™×¨ ×©×œ×š</p>

        <button class="install-btn" onclick="installApp()">×”×ª×§×Ÿ ××¤×œ×™×§×¦×™×”</button>

        <div class="manual-instructions">
            <h3>×”×ª×§× ×” ×™×“× ×™×ª:</h3>
            <p><strong>Chrome/Edge:</strong> ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ â¬‡ ×‘×©×•×¨×ª ×”×›×ª×•×‘×ª</p>
            <p><strong>Safari iPhone:</strong> ×œ×—×¥ ×¢×œ ×©×™×ª×•×£ ğŸ“¤ â†’ "××œ ×”××¡×š ×”×‘×™×ª"</p>
            <p><strong>Android:</strong> ×œ×—×¥ ×¢×œ ×©×œ×•×© × ×§×•×“×•×ª â‹® â†’ "×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª"</p>
        </div>
    </div>

    <script>
        let deferredPrompt = null;

        function installApp() {
            console.log('Install clicked');

            if (deferredPrompt) {
                console.log('Using deferred prompt');
                deferredPrompt.prompt().then((result) => {
                    console.log('Install result:', result);
                    if (result.outcome === 'accepted') {
                        alert('âœ… ×”××¤×œ×™×§×¦×™×” ×ª×•×ª×§×Ÿ ×‘×”×¦×œ×—×”!');
                    } else {
                        alert('×”×ª×§× ×” ×‘×•×˜×œ×”');
                    }
                    deferredPrompt = null;
                });
            } else {
                alert('×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ ×”×”×ª×§× ×” ×‘×“×¤×“×¤×Ÿ ×©×œ×š (×‘×©×•×¨×ª ×”×›×ª×•×‘×ª ××• ×‘×ª×¤×¨×™×˜)');

                // Force show browser install UI for Chrome
                if (window.chrome && window.chrome.webstore) {
                    console.log('Chrome detected');
                }

                // Try to trigger install manually
                if (window.navigator && window.navigator.install) {
                    window.navigator.install();
                }
            }
        }

        // Listen for install prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('ğŸ‰ beforeinstallprompt fired!');
            e.preventDefault();
            deferredPrompt = e;

            // Update button text
            const btn = document.querySelector('.install-btn');
            btn.textContent = '×”×ª×§×Ÿ ×¢×›×©×™×• (×–××™×Ÿ!)';
            btn.style.background = '#28a745';
        });

        window.addEventListener('appinstalled', () => {
            console.log('âœ… App installed!');
            alert('ğŸ‰ ×”××¤×œ×™×§×¦×™×” ×”×•×ª×§× ×” ×‘×”×¦×œ×—×”!');
        });

        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js').then(reg => {
                console.log('Service worker registered:', reg);
            });
        }

        // Check if already installed
        if (window.matchMedia('(display-mode: standalone)').matches) {
            alert('×”××¤×œ×™×§×¦×™×” ×›×‘×¨ ××•×ª×§× ×ª!');
        }
    </script>
</body>
</html>